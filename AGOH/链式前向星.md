[toc]
### 链式前向星
#### 引入
> 无论是**树**还是**图**，我们都需要一种数据结构去存储他们的结构。
> 这种结构就是**链式前向星**。
#### 如何存图
> **邻接矩阵:** 很直观但是空间复杂度非常大。
> &emsp;&emsp;&emsp;&emsp;&ensp;<img src="https://pic.imgdb.cn/item/64a567ac1ddac507ccea9d0d.jpg" width=40%>
> **邻接表:** 因为使用`vector<auto>`进行存储，所以常数复杂度较大，所以就有了邻接表。
> &emsp;&emsp;&emsp;&ensp;<img src="https://pic.imgdb.cn/item/64a56bcc1ddac507ccf5535e.jpg" width=60%>
#### 简介
> 所以就有了链式前向星，**链式前向星**的本质就是邻接表。
> **重要元素:** 
> - `h[MXN], e[MXN], w[MXN], ne[MXN], idx`
>   - `h[MXN]:` 表头，存储的是**计数器**
>   - `e[idx]: idx`要指向的节点（值） 
>   - `w[idx]: idx`存储的值
>   - `ne[idx]: idx`作为新节点**从表头插入**，指向**要指向节点的表头**的**第一个**位置，存储的是**计数器**
>   - `idx:` 计数器，指向**最近没有被使用的节点**
>  
>当看到`e[MXN], ne[MXN], idx`的时候（也有模板使用`tot, cnt`），其实就可以想到平衡树，主席树，动态开点线段树...这类数据结构，
他们是如何开点的，他们的**共同点**都是建立一个内存池，随后有一个**计数器变量**指向**最近的没有被使用的节点，以它为空节点**。链式前向星和它们是同一个思想。
>- `h[MXN]`代表`head`, `h[MXN]`的指向的就是邻接表的第一列，如下图：
<img src="https://pic.imgdb.cn/item/64a575c31ddac507cc0c6a28.jpg" width=60%>
>
##### 循环遍历+解释
```c++
for (int i = h[u]; ~ i; i = ne[i]) 
    int v = e[i], w = w[i];
```
> 以上图为例，首先，我们想看从`u`节点，都指向了谁，所以定义了指针`i = h[u]`，假设`u`是`1`，所以就有一个指针`i`指向了`H1`，
> 如果`i != -1` 就让`i = ne[i]`指向`H1`的下一个节点。所以在`for循环`中就可以取出这个节点指向了谁`e[i]`，以及它的边权`w[i]`。
> 然后发现，`i`指向的`节点1`有一条连向`2`的长度为`3`的边，`i = ne[i]`，也就是让`i`移动到了下一个节点的位置，以此推类直到`i`指向`-1`。<br/>
> **ps:** 注意在这个过程中，我们是不确定**对应节点的计数器的值**是多少的，它只是方便指向**最近的没使用过的节点并且它不会重复，同一条链上可能不连续**，而不是题目给定的值。
##### DFS
```c++
void dfs(int u) 
{
    st[u] = true;
    for (int i = h[u]; ~ i; i = ne[i]) {
        int j = e[i], t = w[i];
        if(!st[j]) dfs(j);
    }
}
```
> 意义没变，就多一个判断，是否搜索过该节点的状态。
##### 加边函数
```c++
int add(int a, int b, int c) 
{
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;
}
```

> 就是一个链表的插入，他不是在链表的末尾插入的，注意，链式前向星是往整个**表头**那一排插入的。
> <img src="https://pic.imgdb.cn/item/64a581e81ddac507cc29db8e.jpg" width=50%> 
> &emsp;&emsp;&emsp;&emsp;**pic: 假设我们要让`5`指向`1`边权为`7`的边(前3句)** <br/>
> 最后`H5`再指向`1`
> <img src="https://pic.imgdb.cn/item/64a584e21ddac507cc319022.jpg" width=50%>
> 插入的前两句就是小链表的初始化，后两句就是一个链表的插入操作。
>
##### 和邻接表区别
> 前面叉掉的，是对于链式前向星来说不存在的，前向星中**只有那些小链表的节点。** 所以前向星其实就是化简后的邻接表。
> <img src="https://pic.imgdb.cn/item/64a585ce1ddac507cc335e74.jpg" width=50%>